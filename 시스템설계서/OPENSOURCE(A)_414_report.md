# 1. 소개

## 1-1. 이 문서의 목적

&nbsp;우리는 주식 투자에 있어 많은 관심을 가진 사람과 또 주식과 관련된 현업을 하는 사람, 또는 주식 투자에 입문하는 사람들을 위해 **통합 주식 투자 시스템**을 설계하고 그 설계 과정을 설명하고자 전반적인 시스템 구조를 담은 시스템 설계서를 작성하게 되었다. 이 문서에서는 **시스템의 설계 동기**, **설계 목표**, **시스템 구조 및 설명**, **유사 서비스 분석**, **사용된 오픈소스에 대한 소개**, 그리고 **시스템의 DFD**에 대해서 다룬다.

## 1-2. 이 문서의 범위

&nbsp;이 시스템을 설계하는 과정에서 주식 관련 정보는 국내 언론사 뉴스와 주식 투자 사이트, 증권사 홈페이지 등을 참조하였다. 서비스 설계 과정에 상용 소프트웨어는 사용하지 않았으며 증권사의 오픈 API 및 오픈소스 소프트웨어만을 사용하였다.

## 1-3. 가정

&nbsp; 시스템 사용에 있어 사용자(투자자)는 주식을 미리 보유하고 있으며 애플리케이션 이용을 위한 회원가입이 진행되어 있어야 한다. 각 주식 종목에 대한 정보가 풍부하게 제공되어(찾아볼 수 있으며) 있으며 주식의 매수와 매도를 진행하는 데 있어 충분한 자금을 가지고 있다고 생각해 시스템 동작에 문제가 없다고 가정한다.


# 2. 설계 개요

## 2-1. 배경 정보

&nbsp; 주식이란 회사의 자본을 구성하는 단위(출처: 네이버 어학사전)이며 우리는 관심 있는 회사의 주식을 구매해 보유할 수 있고 구매한 주식을 다시 판매할 수 있다. 주식 투자란 간단히 그 주식의 구매(매수)와 판매(매도) 행위를 투자자의 적절한 판단으로 시세차익 및 배당금으로 이익을 보는 행위이다. 우리는 본 시스템을 이용하여 주식 투자의 이익률을 극대화하고자 한다.

## 2-2. 설계 동기

1. 정보탐색의 한정
   - 일반 투자자들은 내가 보유한 주식 또는 보유할 주식에 대한 주식회사의 정보를 얻기엔 뉴스나 언론등의 공개 매체에서 얻는 수밖에 없다.
   - 이러한 정보들을 각종 거래소 및 증권사 웹페이지로 부터 가져와 데이터베이스를 구축한 뒤 어플리케이션에서 제공해준다. 투자자들은 정보들을  찾기위한 노력비용이 없이 시스템에서 제공해주는 정보들만으로 많은 정보를 수집할수 있다.
2. 주식투자의 높은 접근성
   - 현재 증권거래소의 구조는 주식의 특성상 기본적인 현재가 부터 시장구분, 고가, 저가, 거래량, 거래대금, 등락률, 대비 등의 무수한 데이터들이 있다.
   - 이러한 정적인 데이터는 사람이 보기에 가독성이 좋지 않으며 주식 정보의 획득과 분석에 있어서 많은 노력이 필요하다.
   - 따라서 이 시스템에서는 정적데이터들을 시각화하여 주식투자 입문자들로 하여금 주식에 보다 편하게 접근할수 있게 한다.
3. 이익의 극대화
   - 주식거래에 있어 우리의 근본적인 목표는 투자금 대비 높은 수익을 내는 것이다.
   - 목표를 달성하는 가장 직관적인 방법으로는 이익이 최대한 많이 발생할 시점에 주식을 거래를 하는 것이고, 이 시스템에서는 학습을 통한 인공지능이 수익이 가장 많이 일어날것으로 예측하는 시점을 알려줘 거래를 진행할수 있게 하여 기존의 거래소와는 다른 차별성을 보여줄수있다.

 회사의 내부 정보는 사내 관계자가 아닌 이상 접근하기 쉽지 않다. 그렇기에 투자자가 매수한 주식의 회사 정보는 언론의 뉴스나 인터넷, 신문 등의 공개 자료로만 수집할 수 있다. 그러한 자료들을 탐색하는 데 드는 수고와 노력에도 불구하고 유의미한 자료를 찾는 데 실패할 수 있으며 그로 인해 이익의 극대화를 위한 주식의 매수/매도 시점을 특정하기는 어렵다. 또한 상대적으로 시각 이미지보다 가독성이 떨어지는 시가, 고가, 대비, 등락 등의 표 데이터들은 한눈에 알아보기 어려워 데이터 분석에 보다 많은 노력을 기울여야 한다. 우리는 이런 단점들을 보완하고자 본 시스템을 설계하게 되었다. 주가에 영향이 갈 만한 주식회사의 뉴스 정보만을 선별해 애플리케이션에 보여주고 여러 증권사 및 거래소 웹페이지의 주가 데이터들을 모아 데이터베이스를 구축하고 시각화한다. 그리고 뉴스 및 주가 데이터를 투자자에게 전달하여 투자자로 하여금 주식 분석을 용이하게 할 수 있게 한다. 또는 투자자가 직접 주가를 분석할 필요 없이 딥러닝을 통한 인공지능을 이용하여 자동 거래를 할 수다면 기존의 주식 거래와 차별점을 이끌어 낼 수 있을 것이라고 생각한다.

## 2-3. 설계 목표

&nbsp;많은 뉴스나 주식 관련 데이터를 수집하는 데 드는 비용과 노력을 줄이기 위해 웹페이지 스크롤링 오픈소스 소프트웨어를 사용하여 여러가지 주식 시세에 영향이 갈 만한 회사 소식 등의 정보를 크롤링한 뒤, 그 데이터를 기반으로 시스템이 자동으로 매수와 매도를 처리하는 것이 첫 번째 목표이다. 더불어 거래 기록 및 데이터를 다시 인공지능에게 전달해 주식 매수/매도 판단의 근거로 삼는 데이터가 될 수 있도록 제공하는 것이 두 번째 목표이다.

# 3. 시스템 서비스 설명

&nbsp;위 가정 상황으로 생각한다.

## &nbsp; 1. 투자자가 애플리케이션에 로그인한다.

> ID, PW 애플리케이션에 전달, 회원 인증 후 로그인



## &nbsp; 2. 로그인한 투자자는 앱으로부터 주식들의 시세를 확인할수 있으며, 특정 키워드가 포함된 뉴스 및 기사를 투자자에게 제공해 준다.

 주가정보데이터를 DB에 넣어 인공지능이 학습할 수 있는 데이터가 되도록 한다.


| 소식    | 주가 정보           | ->   | 사용자    |
| ----- | --------------- | ---- | ------ |
| 뉴스    | 현재가, 시가, 고가     | ->   | 시각 데이터 |
| 사내발표  | 등락가, 시장 구분 등... | ->   | 시각 데이터 |
| 등등... |                 |      |        |

## &nbsp; 3. 만약 주가 상승 등의 긍정적인 정보가 있다면 투자자에게 주식들을 선별해 추천해 줄 수 있도록 한다.

> 최근 가격 상승이 높은 종목 -> 투자자에게 알림 등의 전달



## &nbsp; 4. 투자자는 애플리케이션으로부터 얻은 정보들을 바탕으로 주식 수동 거래 및 자동 거래를 진행할 수 있다.

> 투자자 -> 자동/수동 거래 선택 가능

##   5. 수동 거래 진행 시 증권사 api를 이용하여 직접 거래를 진행한다. 

> 뉴스 및 추천 종목 -> 투자자 판단 -> 증권사 api -> 거래



## &nbsp; 6. 자동 거래 진행 시, DB를 이용해 이익의 극대화를 목표로 학습한 인공지능이 도출한 기준ex) 에 따라 주식 거래를 진행할 수 있게 한다.

> 학습된 인공지능 -> 인공지능 주가 정보 예측 -> 자동 거래 진행
>
> ex) 매도 : 최근 일주일간 가격 상승폭이 30% 이상 등



## &nbsp; 7. 수동 및 자동으로 이루어진 거래의 기록이나 추천 주식 종목 등의 데이터들은 다시 인공지능에게 주어 새로운 학습 데이터가 될 수 있도록 한다.

> 진행된 거래 경험 데이터 -> 인공지능에게 전달 -> 학습 데이터로 전환



# 4. 유사 서비스 분석

###  키움증권 katch 서비스

키움증권에서 제공하는 캐치(KATCH) 서비스는 조건검색기를 활용한 자동 매매프로그램이다. 조건검색기 설정을 활용하여 자신이 원하는 조건을 설정한 뒤 매수에 대한 설정을 하면 자동으로 프로그램이 설정된 조건에 맞게 매수를 반복한다. 매수한 종목의 수익, 손실구간을 설정해 매도 조건도 설정할 수 있다.  또한 '조건식 당 매수 체결 횟수', '로스컷 설정', '당일 매매 여부', '재매수 제한' 등 다양한 조건을 설정할 수 있다.

### 차별성

1. ##### 가독성이 좋은 정보들

   뉴스나 기사로부터 얻은 주식 종목 관련 정보들을 모아 가독성을 높인 시각화된 데이터로 사용자에게 전달한다.

2. ##### 인공지능으로 주식 추천

   사용자가 직접 조건식을 설정해야 하는 키움증권의 katch서비스와는 달리 인공지능으로 주식을 추천해 주식을 잘 모르는 사람들도 쉽고 편하게 자동 매수매도를 가능하게 하였다.


# 5. 사용한 오픈소스 소프트웨어 설명

## 1. 주가 정보 전달 오픈소스 소프트웨어 : beautifulSoup

- 링크 : https://beautiful-soup-4.readthedocs.io/en/latest/# 
- 설명 : 웹의 HTML파일을 크롤링하여 데이터를 추출하는 파이선 패키지
- 선정이유: beautiful soup는 문서 text를 가져오기에 크롤링 속도가 빠르다. 따라서 시각적인 정보가 적은 텍스트 위주의 주가 정보를 가져오는 데 적합하다고 생각하였다.
- 라이선스 : MIT LICENSE

#### 증권사 및 한국거래소(KRX)의 웹페이지에 상장되어 있는 종목들의 시세 및 거래정보를 크롤링하여 얻은 주식 시세 관련 데이터를 DataBase에 저장하는 역할

## 2. 어플리케이션 로그인 오픈소스 : Keycloak

- 링크: https://www.keycloak.org/
- 설명: 어플리케이션에 최소한의 노력으로 보안과 인증을 추가하는 오픈소스
- 선정 이유: 인증과 인가를 쉽게 해 주고 다른 오픈소스보다 많은 기능을 제공해 이 오픈소스를 선정하였다.
- 라이선스: Apache License 2.0

#### &nbsp;Keycloak은 최신 애플리케이션 및 서비스를 위한 ID 및 액세스 관리 오픈소스이다. 사용자를 저장하거나 인증할 필요 없이 즉시 사용 가능하다. 이외에도 강력한 인증, 사용자 관리, 세분화된 인증 등 많은 기능을 제공한다.

## 3. 어플리케이션 제작 오픈소스 소프트웨어 : Kivy

- 링크: https://kivy.org/
- 설명: 파이썬으로 모바일 앱 및 멀티 터치 애플리케이션 소프트웨어를 개발하기 위한 오픈소스이다. 스마트폰 화면 크기에 따라 비율 조절, 터치, 슬라이드 기능을 가지고 있다. Android, IOS,Linux,MacOS,Windows에서 실행 가능하다.
- 선정 이유: 다양한 위젯을 제공하고, 다른 애플리케이션 개발 오픈소스에 비해 개발 문서와 자료 지원이 풍부하다. 전부 무료로 사용 가능하고 상업용 애플리케이션을 개발해도 된다.
- 라이선스: MIT LICENSE

#### 회원 관리, 메뉴 선택, 주식 매매 기능을 가진 애플리케이션의 사용자 인터페이스를 구현하는 역할

## 4. 데이터베이스 오픈소스 소프트웨어 : PostgreSQL

- 오픈소스 링크: https://www.postgresql.org/
- 설명: 관계형 데이터베이스 관리 시스템 중 하나이다. C/C++, Python, Java 등 다양한 프로그래밍 언어 및 어플리케이션을 지원한다. Parallel query 등의 기능을 통해 대량의 데이터를 처리할 수 있다.
- 선정 이유: 관계형 데이터베이스 중 최다 SQL을 지원하며 데이터 무결성 면에서 뛰어난 성능을 보인다.
- 라이선스: PostgreSQL License

#### &nbsp;어플리케이션 내에서 각종 연산을 수행할 수 있도록 사용자 정보 및 데이터들을 구조화하여 저장하는 역할

## 5. KB증권 API
- 링크:

- 설명: 제휴사 계약을 통해 사용할 수 있다. 투자 자문 시 국내/해외 주식, ETF 등의 포트폴리오를 구성하고 일반 주문/예약 주문 등 다양한 방법으로 주문 및 체결 현황 확인까지 가능하다.

- 선정 이유: 타 증권사의 API들은 개인적인 사용만이 가능하며 재배포가 불가능하다는 제약이 있었다. 따라서 부득이하게 회사를 설립해 서비스를 제공한다는 가정 하에 선정하였다.

  #### 주식 주문 체결 및 주식 정보를 제공하는 역할

## 6. Pinot

- 링크: https://engineering.linkedin.com/pinot/open-sourcing-pinot-scaling-wall-real-time-analytics
- 설명: 스트리밍 데이터(고객이 생성하는 여러 가지 데이터 포함) 소스에서 데이터를 직접 수집한다.
- 선정 이유: 높은 데이터 처리량에도 불구하고 훌륭한 분석 기능을 제공한다.
- 라이선스: Apache 2.0

  #### 증권사 API로부터 실시간으로 대규모의 주식 정보를 가져와 데이터를 분석 및 처리해 주는 역할

## 7. Altair

- 링크: https://altair-viz.github.io/  
- 설명: 그래프와 차트를 만들 수 있는 선언적 시각화 라이브러리이다. Vega와 Vega-lite을 기반으로 한다
- 선정 이유: 대규모의 주식 정보를 처리해야 하는 상황에서 쉽고 빠르게 시각화를 할 수 있다.
- 라이선스: BSD 3-Clause 

  #### 증권사 API로부터 가져온 데이터가 처리되고 정제되면 해당 데이터를 주식 차트로 시각화하는 역할

## 8. Pandas

- 링크:
- 설명: 파이썬 프로그래밍 언어를 기반으로 구축된 빠르고 강력한 오픈소스 데이터 조작 도구이다.
- 선정 이유: 쉼표로 구분된 값, JSON, SQL 및 Microsoft Excel과 같은 다양한 파일 형식에서 데이터를 가져올 수 있고, 병합 등의 각종 데이터 처리 동작을 허용하며 재편, 선택을 가능하게 한다.
- 라이선스: BSD 3-Clause

  #### Keras를 통한 학습이 원할하게 이루어지도록 데이터 전처리하는 역할

## 9. Keras

- 링크:
- 설명: 파이썬으로 작성된 오픈 소스 신경망 라이브러리이다. 
- 선정 이유: 딥러닝과의 빠른 실험을 가능케 하도록 설계되었으며 최소한의 모듈 방식의 높은 확장성이 있다.

  #### RNN의 한 종류인 long short term memory 학습을 통해 주가 정보 예측에 활용


# 6. 시스템 DFD(Data Flow Diagram)

![dfd 최종](.\img\dfd 최종.png)